---
status: filled
generated: 2026-01-24
updated: 2026-02-13
---

# DevOps Specialist Agent Playbook

## Mission
The DevOps specialist agent is responsible for the infrastructure, deployment, and operational reliability of the waba-bot platform. Engage this agent for CI/CD pipeline design, Docker/Compose configuration, database infrastructure (PostgreSQL + Redis), environment management, monitoring, and production incident response.

## Responsibilities
- Design and maintain CI/CD pipelines
- Implement infrastructure as code
- Configure monitoring and alerting systems
- Manage container orchestration and deployments
- Optimize cloud resources and cost efficiency
- Manage database migrations and Prisma schema changes
- Maintain environment configuration and secrets management

## Best Practices
- Automate everything that can be automated
- Implement infrastructure as code for reproducibility
- Monitor system health proactively
- Design for failure and implement proper fallbacks
- Keep security and compliance in every deployment

## Skills
- [devops-specialist](../../.agents/skills/devops-specialist/SKILL.md): Comprehensive DevOps skill combining CI/CD, IaC, containers, cloud platforms, observability, security, incident response, and platform engineering.

## Key Project Resources
- Documentation index: [docs/README.md](../docs/README.md)
- Agent handbook: [agents/README.md](./README.md)
- Agent knowledge base: [AGENTS.md](../../AGENTS.md)

## Repository Starting Points
- `apps/` — Contains the core applications: NestJS backend (`apps/backend/`) and Next.js frontend (`apps/frontend/`).
- `apps/backend/` — NestJS API server with Prisma ORM, BullMQ job processing, and Google Gemini AI integration.
- `apps/frontend/` — Next.js dashboard for tenant management, finance, and appointment scheduling.
- `packages/` — Shared workspace packages; notably `api-types` for cross-monorepo type safety.
- `coverage/` — Test coverage reports generated by Jest.

## Infrastructure Inventory

### Container Services (`apps/backend/compose.yml`)
| Service | Image | Port | Purpose |
|---------|-------|------|---------|
| `postgres` | `postgres:18.1-alpine` | 5432 | Primary database (credentials via env vars) |
| `redis` | `redis:8.4.0-alpine` | 6379 | BullMQ job queue and caching |

Both services use `TZ: America/Sao_Paulo` timezone.

### Environment Configuration
| File | Purpose |
|------|---------|
| `apps/backend/.env` | Backend runtime config (DB credentials, API keys, JWT secrets) |
| `apps/backend/.env.test` | Test environment overrides |
| `apps/backend/prisma/schema.prisma` | Database schema definition (source of truth) |
| `apps/backend/prisma.config.ts` | Prisma generator configuration |

### Monorepo Tooling
| File | Purpose |
|------|---------|
| `pnpm-workspace.yaml` | Workspace definition for apps + packages |
| `turbo.json` | Turborepo pipeline config (build, lint, test tasks) |
| `package.json` (root) | Root scripts and workspace dev dependencies |

## Key Files for This Agent

**Infrastructure & Config:**
- [`apps/backend/compose.yml`](../../apps/backend/compose.yml) — Docker Compose for local services
- [`apps/backend/.env`](../../apps/backend/.env) — Environment variables
- [`apps/backend/prisma/schema.prisma`](../../apps/backend/prisma/schema.prisma) — Database schema
- [`turbo.json`](../../turbo.json) — Turborepo pipeline configuration
- [`pnpm-workspace.yaml`](../../pnpm-workspace.yaml) — Monorepo workspace config

**Application Entry Points:**
- [`apps/backend/src/main.ts`](../../apps/backend/src/main.ts) — NestJS bootstrap (port, CORS, Swagger)
- [`apps/backend/src/app.module.ts`](../../apps/backend/src/app.module.ts) — Root module with all imports
- [`apps/backend/package.json`](../../apps/backend/package.json) — Backend scripts (start, build, migrate, test)

## Architecture Context

### Backend Modules (`apps/backend/src/`)

| Module | Purpose |
|--------|---------|
| `ai/` | Conversational AI with Google Gemini, tool orchestration, appointment booking tools |
| `appointments/` | Appointment CRUD, scheduling, operating-hours validation, payment validation |
| `auth/` | Google OAuth, JWT authentication, token management, guards and strategies |
| `calendars/` | Calendar management and provider integrations |
| `common/` | Shared utilities (Prisma include parser, tenant authorization) |
| `customers/` | Customer CRUD with tenant scoping |
| `notifications/` | WhatsApp notification service, appointment payment handler |
| `operating-hours/` | Business hours management with day-of-week scheduling |
| `payments/` | MercadoPago + InfinitePay integration, webhooks, payment preferences, BullMQ processor |
| `plans/` | Tenant service plans (pricing, duration, features) |
| `prisma/` | Global `PrismaService` (connection lifecycle, logging) |
| `saas-plans/` | SaaS subscription plans for the platform itself |
| `services/` | Tenant-offered services (name, description, pricing) |
| `subscriptions/` | SaaS subscription management, billing, customer subscriptions |
| `tenants/` | Multi-tenant management, MercadoPago OAuth, SaaS tenant logic |
| `waba/` | WhatsApp Business API integration, message processing via BullMQ |

### Frontend (`apps/frontend/`)
Next.js app with Google OAuth login, onboarding flow, and a tenant dashboard for managing appointments, customers, services, finance, and operating hours.

### Shared Package (`packages/api-types/`)
TypeScript interfaces and enums shared between frontend and backend for type-safe API contracts.

## Key Symbols for This Agent
- [`PrismaService`](../../apps/backend/src/prisma/prisma.service.ts) — Database connection lifecycle
- [`AppModule`](../../apps/backend/src/app.module.ts) — Root module, all module imports
- [`WabaProcessor`](../../apps/backend/src/waba/waba.processor.ts) — BullMQ message processing queue
- [`main.ts` bootstrap](../../apps/backend/src/main.ts) — Server startup, port, CORS, Swagger config
- [`compose.yml`](../../apps/backend/compose.yml) — Local infrastructure services

## Documentation Touchpoints
- [Documentation Index](../docs/README.md)
- [Project Overview](../docs/project-overview.md)
- [Architecture Notes](../docs/architecture.md)
- [Development Workflow](../docs/development-workflow.md)
- [Testing Strategy](../docs/testing-strategy.md)
- [Glossary & Domain Concepts](../docs/glossary.md)
- [Data Flow & Integrations](../docs/data-flow.md)
- [Security & Compliance Notes](../docs/security.md)
- [Tooling & Productivity Guide](../docs/tooling.md)

## Collaboration Checklist

1. Confirm assumptions with issue reporters or maintainers.
2. Review open pull requests affecting this area.
3. Update the relevant doc section listed above.
4. Capture learnings back in [docs/README.md](../docs/README.md).

## Hand-off Notes

Summarize outcomes, remaining risks, and suggested follow-up actions after the agent completes its work.
